# 投稿共通ルール

## 変換の原則

- master.md を元に各媒体向けに変換する
- 媒体固有のフォーマット要件を遵守する
- 投稿前に人間の最終承認を必ず得る

## 変換マトリクス

| 要素 | note | Qiita | Zenn | WordPress | 社内Git |
|------|------|-------|------|-----------|---------|
| Mermaid図 | テキスト図解に変換 | そのまま | そのまま | そのまま（WP側で対応） | そのまま |
| テーブル | そのまま | そのまま | そのまま | そのまま | そのまま |
| コードブロック | そのまま | そのまま | そのまま | そのまま | そのまま |
| 画像 | WPのURL参照 | WPのURL参照 | WPのURL参照 | MCPでアップロード（原本） | WPのURL参照 |
| frontmatter | なし | なし | YAML追加 | SEOコメント追加 | なし |
| 目次 | 任意 | 自動生成 | 自動生成 | あり | あり |

## トーン

| 媒体 | トーン | 特徴 |
|------|--------|------|
| note | エッセイ調 | 語りかけるような文体、体験・ストーリー性を加える |
| Qiita | 技術記事調 | ですます体、客観的、根拠を添える |
| Zenn | 技術記事調 | ですます体、Qiitaに近いがZenn独自記法を活用 |
| WordPress | SEO記事調 | ですます体、検索意図を意識した見出し |
| 社内Git | フラット技術文書調 | である体OK、社内コンテキスト前提 |

## 構造の調整

| 媒体 | 冒頭 | 末尾 | 固有の追加要素 |
|------|------|------|---------------|
| note | リード文（課題提示＋得られること） | まとめ＋CTA | なし |
| Qiita | 対象読者＋得られること | 参考リンク | タグ（最大5つ） |
| Zenn | 概要 | 参考リンク | frontmatter、メッセージボックス |
| WordPress | リード文（SEO意識） | CTA＋関連記事リンク | SEOメタ情報、カテゴリ・タグ |
| 社内Git | そのまま | そのまま | 社内向け補足コメント |

## Mermaid図の変換ルール（note向け）

Mermaid非対応媒体では以下のパターンで変換する。

### フローチャート → 番号付きリスト

```
1. ステップA
   ↓
2. ステップB
   ↓
3. ステップC
```

### マインドマップ → ネスト箇条書き

```
- **ルート**
  - **子1**
    - 孫1-1
    - 孫1-2
  - **子2**
```

### グラフ/マトリクス → テーブル

```
| カテゴリ | 項目1 | 項目2 |
|----------|-------|-------|
| グループA | ... | ... |
```

## 画像管理

- 画像はWordPressのメディアライブラリをマスターストレージとする
- MCPでWordPressにアップロードし、取得したURLを全媒体で共通参照する
- 画像のアップロードはCONVERTフェーズの最初に行う
- 詳細は `.ai/content/posting/images.md` を参照

## 変換の実行手順

1. strategy.md の「媒体戦略」セクションを読み、投稿対象の媒体を確認
2. `.ai/content/posting/common.md`（本ファイル）+ 各媒体ルールを読み込み
3. 画像があればWordPressにアップロードし、images.md にURL記録
4. master.md をベースに、トーン・フォーマット・構造を変換
5. frontmatter、タグ、SEO情報など媒体固有の要素を追加
6. `platforms/{媒体名}.md` として出力

## 投稿ツール

| 媒体 | ツール | 種別 |
|------|--------|------|
| note | scripts/post-note.py | API |
| Qiita | qiita-cli | CLI |
| Zenn | zenn-cli | CLI |
| WordPress | wordpress-mcp | MCP |
| 社内Git | GitHub MCP | MCP |
| 社内展開 | Slack MCP | MCP |

## 投稿フロー

1. 各ツールで下書きとして投稿
2. 人間が各媒体上で下書きを確認
3. 修正があればCONVERTに戻る
4. 人間の公開承認を得る
5. 各ツールで公開
6. 投稿URLをtrack.mdに記録
7. クロスリンクを各記事に追記
8. Slack MCPで社内に展開

## 投稿順序

WordPress → Qiita → Zenn → note → 社内Git → Slack展開

- WordPressを最初に投稿（画像マスター + SEOインデックス先行）
- 社内Gitは外部URLが揃ってからクロスリンク付きで投稿
- Slack展開は全媒体の公開完了後
